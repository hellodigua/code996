# code996 新功能说明

## 🎯 新增功能

本次更新为 code996 添加了三个强大的新功能，帮助你更深入地了解团队的工作情况：

### 1. 📊 卷王排行榜 - `ranking` 命令

统计并排序仓库中所有提交者的 996 指数，一眼看出谁是团队卷王！

```bash
# 查看所有提交者的996指数排名
code996 ranking

# 查看2024年的排名
code996 ranking -y 2024

# 查看2023-2024年的排名
code996 ranking -y 2023-2024
```

**排行榜展示内容：**

- 🥇🥈🥉 排名及 emoji 标识
- 作者名字和邮箱
- 总提交数
- 996 指数（根据严重程度着色）
- 加班率
- 周末提交比例

**统计摘要：**

- 总提交者数量
- 总提交数
- 平均 996 指数
- 最高/最低 996 指数及对应作者

### 2. 👤 指定作者分析 - `--author` 选项

查看特定提交者的详细工作情况：

```bash
# 查看指定作者的详细信息
code996 ranking --author 张三

# 也可以用邮箱查询
code996 ranking --author zhangsan@company.com

# 结合时间范围
code996 ranking --author 张三 -y 2024
```

**详细信息包括：**

- 作者名字和邮箱
- 总提交数
- 996 指数及描述
- 加班率
- 工作时间提交数 vs 加班时间提交数
- 工作日提交数 vs 周末提交数

### 3. 🚫 排除机器人 - `--exclude-authors` 选项

排除自动化工具和机器人的提交，获得更准确的人工提交统计：

```bash
# 排除单个机器人
code996 ranking --exclude-authors bot

# 排除多个机器人（用逗号分隔）
code996 ranking --exclude-authors bot,CI,github-actions

# 结合其他选项使用
code996 ranking -y 2024 --exclude-authors bot,dependabot
```

**常见需要排除的账号：**

- `bot` - 各类机器人账号
- `CI` - 持续集成系统
- `github-actions` - GitHub Actions
- `dependabot` - 依赖更新机器人
- `renovate` - 依赖管理机器人

## 📖 完整使用示例

### 基础用法

```bash
# 查看整个团队的996指数排名（最近一年）
code996 ranking

# 查看所有历史数据的排名
code996 ranking --all-time

# 查看指定时间段的排名
code996 ranking --since 2024-01-01 --until 2024-12-31
```

### 高级用法

```bash
# 排除机器人后查看真实排名
code996 ranking --exclude-authors bot,CI,github-actions

# 查看某个开发者在2024年的工作情况
code996 ranking --author 李四 -y 2024

# 组合使用：排除机器人，查看2024年Q1的排名
code996 ranking --exclude-authors bot \
  --since 2024-01-01 --until 2024-03-31
```

### 团队场景

```bash
# 场景1: 年终总结，查看全年卷王
code996 ranking -y 2024

# 场景2: 新人培训，展示团队工作模式
code996 ranking --all-time

# 场景3: 项目复盘，查看项目期间的工作强度
code996 ranking --since 2024-06-01 --until 2024-09-30

# 场景4: 个人总结，查看自己的工作数据
code996 ranking --author 我的名字 -y 2024
```

## 🎨 输出示例

### 排行榜输出

```text
🏆 ============ 卷王排行榜 ============ 🏆

┌────────┬──────────────────┬────────────────────────────┬──────────┬──────────┬──────────┬──────────┐
│ 排名   │ 作者             │ 邮箱                       │ 提交数   │ 996指数  │ 加班率   │ 周末提交 │
├────────┼──────────────────┼────────────────────────────┼──────────┼──────────┼──────────┼──────────┤
│ 🥇 1   │ 张三             │ zhangsan@company.com       │ 523      │ 78.5     │ 45.2%    │ 18.3%    │
├────────┼──────────────────┼────────────────────────────┼──────────┼──────────┼──────────┼──────────┤
│ 🥈 2   │ 李四             │ lisi@company.com           │ 412      │ 62.3     │ 38.7%    │ 12.5%    │
├────────┼──────────────────┼────────────────────────────┼──────────┼──────────┼──────────┼──────────┤
│ 🥉 3   │ 王五             │ wangwu@company.com         │ 356      │ 51.2     │ 32.1%    │ 9.8%     │
└────────┴──────────────────┴────────────────────────────┴──────────┴──────────┴──────────┴──────────┘

📈 统计摘要
────────────────────────────────────────────────────────────
  总提交者数量: 15
  总提交数: 3580
  平均996指数: 45.67
  最高996指数: 78.50 (张三)
  最低996指数: 18.20 (钱七)

📖 指标说明
────────────────────────────────────────────────────────────
  • 996指数: 综合工作强度指标，数值越高表示加班越严重
  • 加班率: 非工作时间提交占总提交的比例
  • 周末提交: 周末提交占总提交的比例

💡 提示: 使用 --author <名字> 查看指定作者详情
💡 提示: 使用 --exclude-authors <名字1>,<名字2> 排除机器人
```

### 单个作者详细信息

```text
📊 作者详细信息

┌──────────────────┬──────────────────────────────────────────────────┐
│ 作者名字         │ 张三                                             │
├──────────────────┼──────────────────────────────────────────────────┤
│ 邮箱地址         │ zhangsan@company.com                             │
├──────────────────┼──────────────────────────────────────────────────┤
│ 总提交数         │ 523                                              │
├──────────────────┼──────────────────────────────────────────────────┤
│ 996指数          │ 78.5 (已经996了，关心一下)                       │
├──────────────────┼──────────────────────────────────────────────────┤
│ 加班率           │ 45.2%                                            │
├──────────────────┼──────────────────────────────────────────────────┤
│ 工作时间提交     │ 287                                              │
├──────────────────┼──────────────────────────────────────────────────┤
│ 加班时间提交     │ 236                                              │
├──────────────────┼──────────────────────────────────────────────────┤
│ 工作日提交       │ 427                                              │
├──────────────────┼──────────────────────────────────────────────────┤
│ 周末提交         │ 96 (18.3%)                                       │
└──────────────────┴──────────────────────────────────────────────────┘
```

## 🔧 技术实现

### 核心功能

1. **作者识别**: 通过 `git log --format=%an|%ae` 获取所有提交者
2. **数据收集**: 为每个作者单独收集提交数据
3. **996计算**: 复用现有的 996 指数计算逻辑
4. **智能排序**: 按 996 指数降序排列，展示卷王排行

### 关键文件

- `src/types/git-types.ts` - 新增作者统计类型定义
- `src/git/git-collector.ts` - 添加按作者收集数据的方法
- `src/cli/commands/ranking.ts` - 排名命令实现
- `src/cli/commands/report/ranking-printer.ts` - 排名结果输出
- `src/cli/index.ts` - 注册 ranking 命令和选项

## 💡 使用场景

1. **团队管理**
   - 了解团队成员的工作强度分布
   - 识别可能存在的过度加班情况
   - 为绩效评估提供数据参考

2. **项目复盘**
   - 分析项目不同阶段的人力投入
   - 评估团队工作负荷是否合理
   - 识别关键贡献者

3. **个人规划**
   - 查看自己的工作时间模式
   - 对比团队平均水平
   - 调整工作习惯

4. **招聘参考**
   - 展示团队真实的工作文化
   - 让候选人了解实际工作强度
   - 建立透明的工作环境

## ⚠️ 注意事项

1. **隐私保护**: 所有数据分析均在本地进行，不会上传任何信息
2. **数据准确性**: 基于 Git 提交时间分析，无法覆盖所有工作活动
3. **合理使用**: 结果仅供参考，不应用作绩效考核的唯一依据
4. **排除机器人**: 建议使用 `--exclude-authors` 排除自动化提交，获得更准确的结果

## 🚀 快速开始

```bash
# 安装最新版本
npm install -g code996

# 在项目目录运行
cd your-project
code996 ranking

# 就这么简单！
```

## 📚 更多信息

- 查看完整文档: `code996 help`
- 项目主页: <https://github.com/hellodigua/code996>
- 问题反馈: <https://github.com/hellodigua/code996/issues>
