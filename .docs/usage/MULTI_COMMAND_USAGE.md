# Code996 Multi 命令使用说明

## 功能概述

`code996 multi` 命令用于分析多个 Git 仓库，将它们的提交数据汇总为一个统一的大仓库进行分析，并展示各仓库的 996 指数对比。

## 使用方法

### 基本用法

```bash
# 扫描当前目录的所有子目录
code996 multi

# 扫描指定的多个目录
code996 multi /path/to/dir1 /path/to/dir2
```

### 时间范围选项

```bash
# 指定年份
code996 multi -y 2025

# 指定年份范围
code996 multi -y 2023-2025

# 指定开始和结束日期
code996 multi --since 2024-01-01 --until 2024-12-31

# 分析所有时间
code996 multi --all-time
```

### 其他选项

```bash
# 手动指定工作时间
code996 multi -H 9-18

# 查看帮助
code996 multi --help
```

## 使用流程

1. **扫描阶段**
   - 工具会扫描指定目录（或当前目录的子目录）
   - 自动识别所有 Git 仓库
   - 过滤掉 node_modules、dist 等无关目录

2. **选择阶段**
   - 显示所有找到的仓库列表
   - 通过交互式界面选择要分析的仓库
   - 使用空格键选择，回车键确认

3. **分析阶段**
   - 串行采集各仓库的 Git 数据
   - 显示实时进度
   - 自动跳过采集失败的仓库

4. **合并阶段**
   - 将所有成功的仓库数据合并
   - 按小时、按星期累加提交统计
   - 合并每日首次和最晚提交时间

5. **输出阶段**
   - **主体报表**：汇总后的整体 996 指数分析
     - 核心指标（996 指数、加班比例）
     - 详细分析和建议
     - 工作时间推测
     - 时间分布图表
     - 加班分析（工作日、周末、深夜）

   - **对比报表**：各仓库的 996 指数对比
     - 表格展示各仓库指标
     - 按 996 指数降序排列
     - 显示加班最严重和最轻松的仓库
     - 彩色标识（绿色/黄色/橙色/红色）

## 注意事项

1. **性能考虑**
   - 采集是串行执行的，大量仓库可能需要较长时间
   - 交互式选择时可以根据需要选择部分仓库进行分析

2. **错误处理**
   - 如果某个仓库采集失败，会自动跳过并继续其他仓库
   - 只要有一个仓库成功，就会生成汇总报告

3. **时间范围**
   - **默认策略**：自动检测所有仓库中最新的提交日期，从该日期回溯 1 年
   - 这样既能获得最近的数据，又避免时间跨度过长影响分析准确性
   - 可使用 `--all-time` 分析所有历史数据
   - 可使用 `-y` 或 `--since/--until` 指定特定时间范围
   - 对所有仓库使用相同的时间过滤条件

4. **数据合并策略**
   - 按小时统计：累加各仓库相同小时的提交数
   - 按星期统计：累加各仓库相同星期的提交数
   - 每日首次提交：同一天取最早时间
   - 每日最晚提交：同一天取最晚时间

## 适用场景

- 团队管理多个关联项目
- 分析整个组织的工作强度
- 对比不同项目的加班情况
- 评估团队整体工作负荷
