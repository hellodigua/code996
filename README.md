# code996-cli

[English](./README-en.md) | 简体中文

通过分析 Git commit 的时间分布，计算出项目的"996指数"。

## 📋 项目简介

`code996` 是一个基于 Node.js 的命令行工具，用于统计 Git 项目的 commit 时间分布，进而推导出项目的编码工作强度。它可以帮助你了解团队工作的时间模式，识别潜在的加班文化。

### 为什么要写它

我很介意加班，面试时我都会询问对方的加班情况，但是我发现总有面试官不说实话，但是代码的提交时间不会骗人，因此就有了这个工具。

### 它有什么用

当你入职了新公司，跑一下 `code996`，就可以判断出该公司的加班文化，然后决定是否跑路。

## 🚀 快速开始

### 基本使用

```bash
# 在当前仓库运行分析（默认查询以上次提交为终点开始365天的commit）
code996

# 查看帮助
code996 help
```

## 📖 详细使用说明

### 命令与选项

- `-y, --year <year>`：指定年份或年份范围（推荐）
  - 单年格式：`2025` → 分析 2025-01-01 至 2025-12-31
  - 范围格式：`2023-2025` → 分析 2023-01-01 至 2025-12-31
- `-s, --since <date>`：自定义开始日期 (YYYY-MM-DD)
- `-u, --until <date>`：自定义结束日期 (YYYY-MM-DD)
- `--all-time`：覆盖整个仓库历史数据
- `help`：显示帮助信息

### 使用示例

```bash
# 按年份分析
code996 -y 2025                # 分析2025年
code996 -y 2023-2025           # 分析2023-2025年

# 精确时间范围
code996 --since 2024-01-01 --until 2024-06-30

# 查询整个仓库历史
code996 --all-time
```

默认时间范围说明：

- 未显式指定 `since` / `until` 时，工具会读取仓库的 **最后一次提交日期**，并向前回溯 365 天构成分析窗口。
- 若仓库在该区间内无提交，则自动回退到"当前日期往前一年"的区间保证有数据可分析。

### 核心算法

#### 数据采集流程

```
Git 仓库 → git log 采集 → 日级首提 + 小时分布 → 分位数推算上/下班 → 996 指数计算 → 结果输出
```

#### 关键算法

1. **时间分布分析**：按小时、按星期统计提交数量，绘制 24 小时热力条形图
2. **工作时间识别**：使用最近样本的 10%-20% 分位估算上班时间区间，并结合晚间提交拐点推算下班时间
3. **996 指数计算**：依据加班比例构建指数，并输出中文描述
4. **数据验证**：检验统计数据是否与总提交数一致，避免缺失导致的偏差

## 📄 许可证

MIT License
